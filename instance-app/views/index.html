<%= render(
  'html_head.html',
  {
    title:       popit.pretty_name(),
    description: "Welcome to " + popit.pretty_name(),
  }
) %>

<% if (typeof current_step !== 'undefined') { %>

  <div class="homepage-setup-guide container">
    <div class="container">
      <h2>Set up your new PopIt Instance</h2>
      <div class="row">
        <div class="col-sm-4 col-lg-3 homepage-setup-guide-step <% if (current_step === 1) { %>incomplete<% } else { %>complete<% } %>">
          <h3>
            <% if (current_step === 1) { %>
              <span class="circled-number">1</span>
            <% } else { %>
              <span class="glyphicon glyphicon-ok"></span>
            <% } %>
            Populate
          </h3>
          <p>Add people and organizations to your PopIt instance.</p>
          <a class="new-person add btn <% if (current_step === 1) { %>btn-primary<% } else { %>btn-default<% } %>" href="#"><% if (current_step < 2) { %>
              Add your first person
            <% } else { %>
              Add another person
            <% } %></a>
        </div>
        <div class="col-sm-4 col-lg-3 col-lg-offset-1 homepage-setup-guide-step <% if (current_step === 2) { %>incomplete<% } else { %>complete<% } %>">
          <h3>
            <% if (current_step === 2) { %>
              <span class="circled-number">2</span>
            <% } else { %>
              <span class="glyphicon glyphicon-ok"></span>
            <% } %>
            Describe
          </h3>
          <p>Help people find and understand your instance.</p>
          <a href="/about/edit" class="btn <% if (current_step === 2) { %>btn-primary<% } else { %>btn-default<% } %>">Edit details</a>
        </div>
        <div class="col-sm-4 col-lg-3 col-lg-offset-1 homepage-setup-guide-step incomplete">
          <h3>
            <span class="circled-number">3</span>
            Share
          </h3>
          <p>Connect your data to other websites via the PopIt API.</p>
          <div class="input-group">
            <input type="text" id="api-url" class="form-control" value="http://<%- popit._instance_name %><%- config.instance_site_base_url_suffix %>/api" />
            <span class="input-group-btn">
              <button class="btn <% if (current_step === 3) { %>btn-primary<% } else { %>btn-default<% } %>" type="button">Copy</button>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

<% } else { %>

  <div class="homepage-description">
      <div class="container">
      <div class="row">
        <div class="col-sm-8">
          <% if (typeof popit.setting('description') === 'undefined') { %>
            <p class="lead"><a href="/about/edit">Give your PopIt instance a description</a> and it&rsquo;ll show up here.<p>
          <% } else { %>
            <p class="lead"><%- popit.setting('description') %></p>
          <% } %>
        </div>
        <div class="col-sm-4">
          <a href="/about/edit" class="btn btn-default pull-right">Edit details</a>
        </div>
      </div>
    </div>
  </div>

<% } %>

<% if (person_count > 0 || organization_count > 0) { %>

  <div class="homepage-summaries">
    <div class="container">

      <div id="person-summary" class="homepage-summary-box">
        <h2><%- person_count || 'no' %> <%- person_count == 1 ? 'person' : 'people' %></h2>

        <% if (persons.length) { %>
          <ul class="homepage-summary-list row">
            <% _.each( persons, function(person) { %>
              <li class="col-md-2 col-sm-4">
                <a href="/persons/<%- person.slug %>">
                  <strong title="<%- person.name %>"><%- person.name %></strong>
                  <small title="TODO: current position">TODO: current position</small>
                </a>
              </li>
            <% }); %>
            <% if (person_count > persons.length) { %>
            <li class="col-md-2 col-sm-4">
              <a href="/persons/">Show all <%- person_count %>&hellip;</a>
            </li>
            <% } %>
          </ul>
        <% } %>

        <ul class="homepage-summary-toolbar">
          <li>
            <a class="new-person add btn btn-default btn-xs" href="#">+ Add new person</a>
          </li>
        </ul>
      </div>

      <div id="organization-summary" class="homepage-summary-box">
        <h2><%- organization_count || 'no' %> <%- organization_count == 1 ? 'organization' : 'organizations' %></h2>

        <% if (organizations.length) { %>
          <ul class="homepage-summary-list row">
            <% _.each( organizations, function(organization) { %>
              <li class="col-md-2 col-sm-4">
                <a href="/organizations/<%- organization.slug %>">
                  <strong title="<%- organization.name %>"><%- organization.name %></strong>
                  <small title="TODO: number of members">TODO: number of members</small>
                </a>
              </li>
            <% }); %>
            <% if (organization_count > organizations.length) { %>
            <li class="col-md-2 col-sm-4">
              <a href="/organizations/">Show all <%- organization_count %>&hellip;</a>
            </li>
            <% } %>
          </ul>
        <% } %>

        <ul class="homepage-summary-toolbar">
          <li>
            <a class="new-organization add btn btn-default btn-xs" href="#">+ Add new organization</a>
          </li>
        </ul>
      </div>

    </div>
  </div>

  <div class="homepage-api-guide">
    <div class="container">
      <div class="row">
        <div class="col-sm-6">
          <h2>Reuse this data</h2>
          <p>Share this data with other websites using the PopIt API. Just copy the URL to get started, or <a href="<%- config.hosting_site_base_url %>/docs/api">check out the documentation</a>.</p>
        </div>
        <div class="col-sm-4 col-sm-offset-2">
          <div>
            <label for="api-url">API Base URL:</label>
            <div class="input-group">
              <input type="text" id="api-url" class="form-control" value="http://<%- popit._instance_name %><%- config.instance_site_base_url_suffix %>/api" />
              <span class="input-group-btn">
                <button class="btn btn-default" type="button">Copy</button>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<% } %>

<%= render('html_footer.html' )%>
